<app-navbar></app-navbar>

<div class="container">
  <div *ngIf="data; else noData" class="preview-panel">
    <h2 class="mb-4">Property Details</h2>

    <div class="grid">
      <div class="card">
        <div class="card-title">Property</div>
        <div class="card-body">{{ data?.apartmentName || 'Apartment' }}</div>
      </div>

      <div class="card">
        <div class="card-title">Number of Beds</div>
        <div class="card-body">--</div>
      </div>

      <div class="card">
        <div class="card-title">Address</div>
        <div class="card-body">{{ data?.location }}</div>
      </div>

      <div class="card">
        <div class="card-title">Rent</div>
        <div class="card-body">{{ (data?.expectedRent ? ('$' + data?.expectedRent + '/month') : '--') }}</div>
      </div>

      <div class="card wide">
        <div class="card-title">Description</div>
        <div class="card-body">{{ data?.description }}</div>
      </div>

      <div class="card wide">
        <div class="card-title">Amenities</div>
        <div class="card-body">
          <ul>
            <li *ngFor="let key of amenitiesKeys">{{ key }}</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="photos">
      <h4>Photos</h4>
      <div class="photo-grid">
        <div class="photo-box" *ngIf="data?.image">
          <img [src]="data.image" alt="Uploaded Property Photo" style="max-width:100%;max-height:200px;" />
        </div>
        <div class="photo-box" *ngIf="!data?.image">
          No photo uploaded.
        </div>
      </div>
    </div>

    <div style="display: none;" class="actions">
      <button class="btn btn-secondary" (click)="edit()">Edit</button>
      <button class="btn btn-primary" (click)="confirm()">Confirm & Submit</button>
    </div>

    <!-- Comments Section -->
    <div class="comments-section mt-5">
      <h4>Comments</h4>
      <div *ngIf="comments && comments.length > 0; else noComments">
        <div class="comment-box" *ngFor="let comment of comments">
          <div class="comment-user"><strong>{{ comment.user }}</strong>:</div>
          <div class="comment-text">{{ comment.text }}</div>
        </div>
      </div>
      <ng-template #noComments>
        <div class="text-muted">No comments yet. Be the first to comment!</div>
      </ng-template>
      <form (ngSubmit)="addComment()" #commentForm="ngForm" class="mt-3">
        <div class="form-group">
          <input type="text" [(ngModel)]="newComment" name="newComment" class="form-control" placeholder="Add a comment..." required />
        </div>
        <button type="submit" class="btn btn-primary mt-2" [disabled]="!newComment">Post Comment</button>
      </form>
    </div>
  </div>
  <ng-template #noData>
    <div class="preview-panel">
      <h2 class="mb-4">Preview and Submit</h2>
      <div class="alert alert-warning">No post found for this ID.</div>
    </div>
  </ng-template>
</div>
